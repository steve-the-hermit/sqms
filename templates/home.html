{% extends 'base.html' %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary">Smart Queue System</h2>
        <button class="btn btn-outline-secondary" onclick="toggleDarkMode()">Toggle Dark Mode</button>
    </div>

    {% if queue %}
    <div class="table-responsive">
        <table class="table table-bordered table-hover table-striped align-middle">
            <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Patient Name</th>
                    <th>Phone</th>
                    <th>Check-in Time</th>
                    <th>Assigned Doctor</th>
                </tr>
            </thead>
            <tbody>
                {% for entry, patient, doctor in queue %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ patient.name }}</td>
                    <td>{{ patient.phone }}</td>
                    <td>{{ entry.arrival_time.strftime('%d %b %Y, %H:%M') }}</td>
                    <td>{{ doctor.name if doctor else 'Unassigned' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-info text-center">No patients currently in the queue.</div>
    {% endif %}
</div>

<!-- Scroll to Top -->
<button onclick="scrollToTop()" id="scrollBtn" class="btn btn-primary rounded-circle shadow" style="position:fixed;bottom:30px;right:30px;display:none;">
    â†‘
</button>

{% endblock %}

{% block scripts %}
<script>
    // Scroll-to-top button visibility
    window.onscroll = function() {
        document.getElementById("scrollBtn").style.display = window.scrollY > 200 ? "block" : "none";
    };

    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Dark mode toggle
    function toggleDarkMode() {
        document.body.classList.toggle('bg-dark');
        document.body.classList.toggle('text-light');
        const tables = document.querySelectorAll('table');
        tables.forEach(table => {
            table.classList.toggle('table-dark');
        });
    }
</script>
{% endblock %}
